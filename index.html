<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Visualizing Immunization Effectiveness</title>

    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <link href="css/ie10-viewport-bug-workaround.css" rel="stylesheet">

    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <!--[if lt IE 9]><script src="js/ie8-responsive-file-warning.js"></script><![endif]-->
    <script src="js/ie-emulation-modes-warning.js"></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Custom styles for this template -->
    <link href="css/carousel.css" rel="stylesheet">
    <link href="css/immunization.css" rel="stylesheet">

    <script src="js/jquery.min.js"></script>
    <script src="js/d3.min.js"></script>
    <script src="js/holder.min.js"></script>
    <script src="js/queue.v1.min.js"></script>
    <script src="js/topojson.v1.min.js"></script>
    <script src="js/colorbrewer.js"></script>

    <script>
      var lineChart;
      var smallMultiples;

      function selectCountry(isoCode) {
        lineChart.highlightCountry(isoCode);
        smallMultiples.showCountry(isoCode);
        // other calls could go here
      }

      function selectRange(startYear, endYear) {
        smallMultiples.updateRange(startYear, endYear);
        // other calls could go here
      }
    </script>

    <script src="js/africamap.js"></script>
    <script src="js/africamap_draw.js"></script>
    <script src="js/graphtest.js"></script>
    <script src="js/map_link.js"></script>
    <script src="js/smallmultiples.js"></script>


    <script>
      $(document).ready(function() {
        lineChart = initializeLineChart();
        smallMultiples = initializeSmallMultiples();

        draw_africa();

        var apiBaseUrl = "https://demo.sheinin.ca/w209/api/"
        // For testing with a local Django installation
        //var apiBaseUrl = "http://localhost:8000/api/"

        var smallMultiplesReady = false;
        $.getJSON(apiBaseUrl + "fetch/incidence/", function (data) {
          smallMultiples.update(data);
          smallMultiplesReady = true;
        });

        function updateViz(data) {

          var user_year1 = 2014;
          var user_year2 = 2014;

          if (!smallMultiplesReady) {
            setTimeout(function() { updateViz(data); }, 500);
          }

          lineChart.update(data);
          color_africa(user_year1, user_year2, data);

          $("#viz-heading").html("Immunization Coverage: " + data.group_description);

          $("#loading").hide();
          $("#myviz").slideDown();
          $("html, body").animate({scrollTop: 0}, "slow");

          $(".sm-mul.group-" + data.group_slug).css({
            "border-color": "#80e5ff",
            "border-weight": "2px",
            "border-style": "solid"
          });
          $(".sm-mul").not(".group-" + data.group_slug).css({"border": "none"});
        }

        $('.vac-group-btn').on('click', function (e) {
          $("#loading").show();

          var user_disease_group = $(this).attr("id");

          $('.vac-group-btn').removeClass('btn-info').addClass('btn-primary ');  //change color of clicked button
          $(this).addClass('btn-info').removeClass('btn-primary ');

          $.getJSON(apiBaseUrl + "fetch/coverage/" + user_disease_group + "/", function (data) {
            updateViz(data);
          });
        });
      });

    </script>

  </head>
<!-- NAVBAR
================================================== -->
  <body>
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href=".">Visualizing Immunization Effectiveness in Africa</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="active"><a href=".">Home</a></li>
            <li><a href="#use_cases">Visualization Use Cases</a></li>
            <li><a href="#meettheteam">Meet the Team</a></li>
            <!--li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">More Options<span class="caret"></span></a>
              <ul class="dropdown-menu">
                <li><a href="#myDashboard">Take Me to the Dashboard</a></li>
                <li><a href="#meettheteam">Meet the Team</a></li>
              </ul>
            </li-->

          </ul>
        </div>
      </div>


      <div class="btn-group btn-group-justified">
        <a class="btn btn-primary vac-group-btn" id='measles'>Measles</a>
        <a class="btn btn-primary vac-group-btn" id='dpt'>Diphtheria, Tetanus, Pertussis</a>
        <a class="btn btn-primary vac-group-btn" id='pab'>Neonatal Tetenus</a>
        <a class="btn btn-primary vac-group-btn" id='polio'>Polio</a>
        <a class="btn btn-primary vac-group-btn" id='yfv'>Yellow Fever</a>
      </div>

      <div class="text-center" id="loading">
        Loading... <span class="glyphicon glyphicon-refresh spinning"></span>
      </div>

    </nav>

    <div class="container">

      <div id="myviz">

        <h3 id="viz-heading"></h3>

        <div class="dashboard">
          <!-- Indicators -->
          <div class="row">

            <div class="col-md-4">
              <!--img data-src="holder.js/100%x500/white"-->
              <div id="country-list"></div>
              <script>
                //******* adding drop down bar
                var dropDown = d3.select("#country-list").append("select")
                        .attr("name", "country-list");
              </script>
              <div class="africamap"></div>

            </div>
            <div class="col-md-8">
              <div style="height:10px"></div>
              <!--h5>Line Chart - Immunization Rate over Time</h5-->
              <div id="graphtest"></div>

            </div>
          </div>

          <h4>Reported Disease Incidence</h4>

          <div class="row">
            <div class="col-md-14 col-sm-2 nopadding sm-mul group-measles"> <!--measles-->
              <h5 class="sm-mul-heading">Measles</h5>
              <div id="sm_mul1"></div>
              <!--<img data-src="holder.js/100%x100/white">-->
            </div>
            <div class="col-md-14 col-sm-2 nopadding sm-mul group-dpt"> <!--dipththeria-->
              <h5 class="sm-mul-heading">Diphtheria</h5>
              <div id="sm_mul2"></div>
            </div>
            <div class="col-md-14 col-sm-2 nopadding sm-mul group-dpt"> <!--tetanus-->
              <h5 class="sm-mul-heading">Tetanus</h5>
              <div id="sm_mul3"></div>
            </div>
            <div class="col-md-14 col-sm-2 nopadding sm-mul group-dpt"> <!--pertussis-->
              <h5 class="sm-mul-heading">Pertussis</h5>
              <div id="sm_mul4"></div>
            </div>
            <div class="col-md-14 col-sm-2 nopadding sm-mul group-pab"> <!--neonatal tetanus-->
              <h5 class="sm-mul-heading">Neonatal Tetanus</h5>
              <div id="sm_mul5"></div>
            </div>
            <div class="col-md-14 col-sm-2 nopadding sm-mul group-polio"> <!--polio-->
              <h5 class="sm-mul-heading">Polio</h5>
              <div id="sm_mul6"></div>
            </div>
            <div class="col-md-14 col-sm-2 nopadding sm-mul group-yfv"> <!--yellow fever-->
              <h5 class="sm-mul-heading">Yellow Fever</h5>
              <div id="sm_mul7"></div>
            </div>
          </div>
        </div><!-- /.dashboard -->

      </div>

      <!-- Dashboard
      ================================================== -->
      <div class="" id="dashboard_start">
        <!--h3 id="myDashboard" style="text-align:center">Immunization Effectiveness Dashboard</h3-->
        <div id="instructions" class="fade in active" style="height:600px;">

          <h3>Visualization Instructions</h3>
          <p>To start using this visualization, click on the "Go to Visualization" tab above and select one of buttons for disease type.</p>
          <p>Or to learn more, please hover over each section of the image below to learn more about our dashboard.</p>

          <div class="row">
            <div class="col-md-6" >
              <div class="row" id="instr-img1">
                <img src="images/img1.jpg" alt="" width="100%" height="100%">
              </div>
              <div class="row">
                <div class="col-md-5" id="instr-img2">
                  <img src="images/img2.jpg" alt="" width="100%" height="100%">
                </div>
                <div class="col-md-7" id="instr-img3">
                  <img src="images/img3.jpg" alt="" width="100%" height="100%">
                </div>
              </div>
              <div class="row" id="instr-img4">
                <img src="images/img4.jpg" alt="" width="100%" height="100%">
              </div>
            </div>
            <div class="col-md-6" id="instr-text">
              <span><br><br><br><br><h2 align=center>Welcome to our Visualization!</h2><br><br><h4>Hover over each section to the right to learn more about our dashboard.</h4></span>
            </div>
          </div>

          <script>
            $(document).ready(function(){ //start of instructions display

              $( "#instr-img1" ).hover(  //disease types and data source
                      function() {
                        $( "#instr-text" ).find( "span:last" ).remove();

                        var url = "http://www.who.int/immunization/monitoring_surveillance/data/en/";
                        $( "#instr-text" ).append( $( "<span>\
                                             <h3>Immunization Effectiveness in Africa</h3>\
                                             <p><strong>To begin using this tool, </strong>select a disease to investigate.</p>\
                                             <p>This tool focuses on seven different types of preventable, communicable diseases:</p>\
                                             <ul>\
                                             <li><strong>Measles: </strong>is a highly contagious, serious disease caused by a virus.</li>\
                                             <li><strong>Diphtheria: </strong>is a bacterial disease that can harm or destroy human body tissues and organs.</li>\
                                             <li><strong>Tetanus: </strong> is a serious bacterial disease that affects your nervous system.</li>\
                                             <li><strong>Pertussis: </strong>is a highly contagious bacterial disease of the respiratory tract</li>\
                                             <li><strong>Neonatal Tetenus: </strong>is a form of generalised tetanus that occurs in newborns.</li>\
                                             <li><strong>Polio: </strong>is a highly infectious disease that invades the nervous system and can cause total paralysis.</li>\
                                             <li><strong>Yellow Fever: </strong>is an acute viral haemorrhagic disease transmitted by infected mosquitoes.</li>\
                                             </ul>\
                                             <p>Source: <a href=" + url + " target='_blank'>" + url + "</a></p>\
                                             </span>" ) );

                      }
              );

              $( "#instr-img2" ).hover(  //African countries
                      function() {

                        $( "#instr-text" ).find( "span:last" ).remove();

                        var url = "http://www.who.int/immunization/monitoring_surveillance/data/en/";

                        $( "#instr-text" ).append( $( "<span>\
                                             <h3>Focus on Africa</h3>\
                                             <p>This tool is used to visualize the effectiveness of immunization strategy in African nations. <strong>Hover over a country or use the dropdown</strong> to select a country to investigate.</p>\
                                             <p>The data presented in this tool is from the World Health Organization (WHO).</p>\
                                             <p><strong>World Health Organization: </strong> Its primary role is to direct and coordinate international health within the United Nations’ system.\
                                              The WHO's main areas of work are:</p>\
                                             <ul>\
                                             <li>Health systems</li>\
                                             <li>Promoting health through the life-course</li>\
                                             <li>Noncommunicable diseases</li>\
                                             <li>Communicable diseases</li>\
                                             <li>Corporate services</li>\
                                             <li>Preparedness, surveillance and response.</li>\
                                             </ul>\
                                             <p>Source: <a href=" + url + " target='_blank'>" + url + "</a></p>\
                                             </span>" ) );

                      }
              );

              $( "#instr-img3" ).hover(  //immunization rates
                      function() {

                        $( "#instr-text" ).find( "span:last" ).remove();

                        $( "#instr-text" ).append( $( "<span>\
                                             <h3>Immunization Rates Over Time</h3>\
                                             <p>This line chart displays the immunization rates over time for each African country in our dataset.</p>\
                                             <strong>Hover over the line</strong> to select a country to investigate and <strong>interact with the brush</strong> to select a desired time range.</p>\
                                             <p>The data presented in this tool is from the World Health Organization (WHO) and covers the years 1980 through 2014.</p>\
                                             </span>" ) );
                      }
              );

              $( "#instr-img4" ).hover(  //incidence rates
                      function() {

                        $( "#instr-text" ).find( "span:last" ).remove();

                        $( "#instr-text" ).append( $( "<span>\
                                             <h3>Disease Incidence Over Time</h3>\
                                             <p>This group of line charts display disease incidence rates over time for the selected African country and all seven of the different diseases. The chart for the selected disease is highlighted in blue.</p>\
                                             <strong>Hover over the line chart above or map, or use the dropdown</strong> to select a country to investigate. Also, <strong>interact with the brush</strong> to select a desired time range.</p>\
                                             <p>The data presented in this tool is from the World Health Organization (WHO) and covers the years 1980 through 2014.</p>\
                                             </span>" ) );
                      }
              );
            })//end of instructions display


          </script>
        </div>
      </div>


      <!-- Marketing messaging and featurettes
      ================================================== -->
      <!-- Wrap the rest of the page in another container to center all the content. -->

      <div class="marketing" >

        <!-- START THE FEATURETTES -->
        <hr class="featurette-divider" id="use_cases">
        <h2 class="featurette-heading" align="center">Visualizing Immunization Effectiveness in Africa</h2>
        <br><br><br>

        <div class="row featurette">
          <div class="col-md-7">
            <h3 class="featurette-heading">Are immunizations effective?</h3>
            <p class="lead">Section to be completed with use case from visualization.</p>
          </div>
          <div class="col-md-5">
            <!--img class="featurette-image img-responsive center-block" data-src="holder.js/500x500/auto" alt="Generic placeholder image"-->
            <img src="images/img_usecase1.jpg" alt="" width="450px" style="vertical-align:middle">
          </div>
        </div>

        <hr class="featurette-divider">

        <div class="row featurette">
          <div class="col-md-7 col-md-push-5">
            <h3 class="featurette-heading">Which countries need more international aid for health programs?</h3>
            <p class="lead">Section to be completed with use case from visualization.</p>
          </div>
          <div class="col-md-5 col-md-pull-7">
            <!--img class="featurette-image img-responsive center-block" data-src="holder.js/500x500/auto" alt="Generic placeholder image"-->
            <img src="images/img_usecase2.jpg" alt="" width="450px" style="vertical-align:middle">
          </div>
        </div>

        <hr class="featurette-divider">

        <div class="row featurette">
          <div class="col-md-7">
            <h3 class="featurette-heading">Which diseases require renewed focus to combat?</h3>
            <p class="lead">Section to be completed with use case from visualization.</p>
          </div>
          <div class="col-md-5">
            <!--img class="featurette-image img-responsive center-block" data-src="holder.js/500x500/auto" alt="Generic placeholder image"-->
            <img src="images/img_usecase3.jpg" alt="" width="450px" style="vertical-align:middle">
          </div>
        </div>

        <hr class="featurette-divider">

        <!-- /END THE FEATURETTES -->


        <!-- Three columns of text below the carousel -->
        <h2 class="featurette-heading" id="meettheteam" style="text-align:center">Meet The Team</h2><br><br>
        <div class="row">
          <div class="col-lg-4">
            <img class="img-circle" src="data:image/gif;base64,R0lGODlhAQABAIAAAHd3dwAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==" alt="Generic placeholder image" width="140" height="140">
            <h3>Daniel</h3>
            <p>MIDS Student</p>
          </div><!-- /.col-lg-4 -->
          <div class="col-lg-4">
            <img class="img-circle" src="data:image/gif;base64,R0lGODlhAQABAIAAAHd3dwAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==" alt="Generic placeholder image" width="140" height="140">
            <h3>Jaime</h3>
            <p>MIDS Student</p>
          </div><!-- /.col-lg-4 -->
          <div class="col-lg-4">
            <img class="img-circle" src="images/al.jpg" alt="" width=25% height=25%>
            <h3>Al</h3>
            <p>MIDS Student</p>
          </div><!-- /.col-lg-4 -->
        </div><!-- /.row -->

      </div>

      <!-- FOOTER -->
      <footer>
        <p class="pull-right"><a href="#">Back to top</a></p>
        <p>&copy; Spring 2016 MIDS W209 Final Project</p>
      </footer>

    </div><!-- /.container -->


    <!-- Placed at the end of the document so the pages load faster -->
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')</script>
    <script src="js/bootstrap.min.js"></script>
    <!-- Just to make our placeholder images work. Don't actually copy the next line! -->
    <script src="js/holder.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="js/ie10-viewport-bug-workaround.js"></script>

  </body>
</html>
